image:
  file: .gitpod.Dockerfile

tasks:

    - name: run
      init: |
          cd /workspace
          apt-get update && sudo

    - name: install mamba 
      init: |
          cd /workspace
          wget "https://github.com/conda-forge/miniforge/releases/latest/download/Mambaforge-$(uname)-$(uname -m).sh"
          bash Mambaforge-$(uname)-$(uname -m).sh -b -p /workspace/mambaforge && rm Mambaforge-$(uname)-$(uname -m).sh
          /workspace/mambaforge/bin/mamba init bash
          source ${HOME}/.bashrc
    - name: Install R
      command: |
          cd /workspace
          sudo apt-get update
          sudo apt-get install -y r-base
     
    - name: Install Nextflow & nf core
      command: |
          cd /workspace
          curl -s https://get.nextflow.io | bash
          sudo mv nextflow /bin/
          export PATH=/bin:$PATH
    
    - name: Install Nextflow & nf core
      command: |
          cd /workspace
          pip install nf-core

    - name: retrieve references data
      command: |
          cd /workspace
          curl -L -o ref.tar.xz https://cloud.uni-konstanz.de/index.php/s/jkW6m7BCXZtHxKs/download?file=filename.tar.xz
          tar -xf ref.tar.xz
          rm -rf ref.tar.xz
          
workspaceLocation: "/workspace"

tasks:
    - name: Start web server
      init: python -m http.server 8000

ports:
    - port: 8000
      onOpen: open-preview
